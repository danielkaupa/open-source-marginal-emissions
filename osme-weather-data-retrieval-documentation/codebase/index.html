
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://danielkaupa.github.io/open-source-marginal-emissions/osme-weather-data-retrieval-documentation/codebase/">
      
      
        <link rel="prev" href="../configuration/">
      
      
        <link rel="next" href="../../osme-grid-data-retrieval-documentation/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>Codebase - Open Source Marginal Emissions — Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Open Source Marginal Emissions — Docs" class="md-header__button md-logo" aria-label="Open Source Marginal Emissions — Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Open Source Marginal Emissions — Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Codebase
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_1">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/danielkaupa/open-source-marginal-emissions" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    danielkaupa/open-source-marginal-emissions
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  
  Overview

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  Packages

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Open Source Marginal Emissions — Docs" class="md-nav__button md-logo" aria-label="Open Source Marginal Emissions — Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Open Source Marginal Emissions — Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/danielkaupa/open-source-marginal-emissions" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    danielkaupa/open-source-marginal-emissions
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Overview
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to this Repository
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CORE_CONCEPTS_AND_DEFINITIONS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Core Concepts and Definitions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../PROJECT_ROADMAP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Project Roadmap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ACKNOWLEDGEMENTS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Acknowledgements
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Packages
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Packages
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Weather Data Retrieval
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Weather Data Retrieval
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Codebase
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Codebase
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#package-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Package Structure
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Core Modules
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Modules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#entry-point-orchestration" class="md-nav__link">
    <span class="md-ellipsis">
      Entry Point &amp; Orchestration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Entry Point &amp; Orchestration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mainpy" class="md-nav__link">
    <span class="md-ellipsis">
      main.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
    <nav class="md-nav" aria-label="main">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.main.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#runnerpy" class="md-nav__link">
    <span class="md-ellipsis">
      runner.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.runner" class="md-nav__link">
    <span class="md-ellipsis">
      runner
    </span>
  </a>
  
    <nav class="md-nav" aria-label="runner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.runner.run" class="md-nav__link">
    <span class="md-ellipsis">
      run
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.runner.run_batch_from_config" class="md-nav__link">
    <span class="md-ellipsis">
      run_batch_from_config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inputoutput-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Input/Output Modules
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Input/Output Modules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ioclipy" class="md-nav__link">
    <span class="md-ellipsis">
      io/cli.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="io/cli.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.io.cli" class="md-nav__link">
    <span class="md-ellipsis">
      cli
    </span>
  </a>
  
    <nav class="md-nav" aria-label="cli">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.io.cli.parse_args" class="md-nav__link">
    <span class="md-ellipsis">
      parse_args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.io.cli.run_prompt_wizard" class="md-nav__link">
    <span class="md-ellipsis">
      run_prompt_wizard
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iopromptspy" class="md-nav__link">
    <span class="md-ellipsis">
      io/prompts.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="io/prompts.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.io.prompts" class="md-nav__link">
    <span class="md-ellipsis">
      prompts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="prompts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.io.prompts.read_input" class="md-nav__link">
    <span class="md-ellipsis">
      read_input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.io.prompts.say" class="md-nav__link">
    <span class="md-ellipsis">
      say
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.io.prompts.prompt_data_provider" class="md-nav__link">
    <span class="md-ellipsis">
      prompt_data_provider
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.io.prompts.prompt_dataset_short_name" class="md-nav__link">
    <span class="md-ellipsis">
      prompt_dataset_short_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.io.prompts.prompt_cds_url" class="md-nav__link">
    <span class="md-ellipsis">
      prompt_cds_url
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.io.prompts.prompt_cds_api_key" class="md-nav__link">
    <span class="md-ellipsis">
      prompt_cds_api_key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.io.prompts.prompt_save_directory" class="md-nav__link">
    <span class="md-ellipsis">
      prompt_save_directory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.io.prompts.prompt_date_range" class="md-nav__link">
    <span class="md-ellipsis">
      prompt_date_range
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.io.prompts.prompt_coordinates" class="md-nav__link">
    <span class="md-ellipsis">
      prompt_coordinates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.io.prompts.prompt_variables" class="md-nav__link">
    <span class="md-ellipsis">
      prompt_variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.io.prompts.prompt_skip_overwrite_files" class="md-nav__link">
    <span class="md-ellipsis">
      prompt_skip_overwrite_files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.io.prompts.prompt_parallelisation_settings" class="md-nav__link">
    <span class="md-ellipsis">
      prompt_parallelisation_settings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.io.prompts.prompt_retry_settings" class="md-nav__link">
    <span class="md-ellipsis">
      prompt_retry_settings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.io.prompts.prompt_continue_confirmation" class="md-nav__link">
    <span class="md-ellipsis">
      prompt_continue_confirmation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ioconfig_loaderpy" class="md-nav__link">
    <span class="md-ellipsis">
      io/config_loader.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="io/config_loader.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.io.config_loader" class="md-nav__link">
    <span class="md-ellipsis">
      config_loader
    </span>
  </a>
  
    <nav class="md-nav" aria-label="config_loader">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.io.config_loader.load_and_validate_config" class="md-nav__link">
    <span class="md-ellipsis">
      load_and_validate_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.io.config_loader.load_config" class="md-nav__link">
    <span class="md-ellipsis">
      load_config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-provider-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Data Provider Modules
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Provider Modules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sourcescds_era5py" class="md-nav__link">
    <span class="md-ellipsis">
      sources/cds_era5.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sources/cds_era5.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.sources.cds_era5" class="md-nav__link">
    <span class="md-ellipsis">
      cds_era5
    </span>
  </a>
  
    <nav class="md-nav" aria-label="cds_era5">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.sources.cds_era5.prepare_cds_download" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_cds_download
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.sources.cds_era5.execute_cds_download" class="md-nav__link">
    <span class="md-ellipsis">
      execute_cds_download
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.sources.cds_era5.download_cds_month" class="md-nav__link">
    <span class="md-ellipsis">
      download_cds_month
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.sources.cds_era5.plan_cds_months" class="md-nav__link">
    <span class="md-ellipsis">
      plan_cds_months
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.sources.cds_era5.orchestrate_cds_downloads" class="md-nav__link">
    <span class="md-ellipsis">
      orchestrate_cds_downloads
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sourcesopen_meteopy" class="md-nav__link">
    <span class="md-ellipsis">
      sources/open_meteo.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sources/open_meteo.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.sources.open_meteo" class="md-nav__link">
    <span class="md-ellipsis">
      open_meteo
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utility-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Utility Modules
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Utility Modules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#utilssession_managementpy" class="md-nav__link">
    <span class="md-ellipsis">
      utils/session_management.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="utils/session_management.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.session_management" class="md-nav__link">
    <span class="md-ellipsis">
      session_management
    </span>
  </a>
  
    <nav class="md-nav" aria-label="session_management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.session_management.SessionState" class="md-nav__link">
    <span class="md-ellipsis">
      SessionState
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SessionState">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.session_management.SessionState.first_unfilled_key" class="md-nav__link">
    <span class="md-ellipsis">
      first_unfilled_key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.session_management.SessionState.summary" class="md-nav__link">
    <span class="md-ellipsis">
      summary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.session_management.SessionState.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      to_dict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.session_management.get_cds_dataset_config" class="md-nav__link">
    <span class="md-ellipsis">
      get_cds_dataset_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.session_management.map_config_to_session" class="md-nav__link">
    <span class="md-ellipsis">
      map_config_to_session
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.session_management.ensure_cds_connection" class="md-nav__link">
    <span class="md-ellipsis">
      ensure_cds_connection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.session_management.internet_speedtest" class="md-nav__link">
    <span class="md-ellipsis">
      internet_speedtest
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utilsdata_validationpy" class="md-nav__link">
    <span class="md-ellipsis">
      utils/data_validation.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="utils/data_validation.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.data_validation" class="md-nav__link">
    <span class="md-ellipsis">
      data_validation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="data_validation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.data_validation.normalize_input" class="md-nav__link">
    <span class="md-ellipsis">
      normalize_input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.data_validation.format_duration" class="md-nav__link">
    <span class="md-ellipsis">
      format_duration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.data_validation.format_coordinates_nwse" class="md-nav__link">
    <span class="md-ellipsis">
      format_coordinates_nwse
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.data_validation.month_days" class="md-nav__link">
    <span class="md-ellipsis">
      month_days
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.data_validation.validate_data_provider" class="md-nav__link">
    <span class="md-ellipsis">
      validate_data_provider
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.data_validation.validate_dataset_short_name" class="md-nav__link">
    <span class="md-ellipsis">
      validate_dataset_short_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.data_validation.validate_cds_api_key" class="md-nav__link">
    <span class="md-ellipsis">
      validate_cds_api_key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.data_validation.validate_directory" class="md-nav__link">
    <span class="md-ellipsis">
      validate_directory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.data_validation.validate_date" class="md-nav__link">
    <span class="md-ellipsis">
      validate_date
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.data_validation.parse_date_with_defaults" class="md-nav__link">
    <span class="md-ellipsis">
      parse_date_with_defaults
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.data_validation.clamp_era5_available_end_date" class="md-nav__link">
    <span class="md-ellipsis">
      clamp_era5_available_end_date
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.data_validation.validate_coordinates" class="md-nav__link">
    <span class="md-ellipsis">
      validate_coordinates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.data_validation.validate_variables" class="md-nav__link">
    <span class="md-ellipsis">
      validate_variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.data_validation.validate_existing_file_action" class="md-nav__link">
    <span class="md-ellipsis">
      validate_existing_file_action
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.data_validation.validate_config" class="md-nav__link">
    <span class="md-ellipsis">
      validate_config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utilsfile_managementpy" class="md-nav__link">
    <span class="md-ellipsis">
      utils/file_management.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="utils/file_management.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.file_management" class="md-nav__link">
    <span class="md-ellipsis">
      file_management
    </span>
  </a>
  
    <nav class="md-nav" aria-label="file_management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.file_management.generate_filename_hash" class="md-nav__link">
    <span class="md-ellipsis">
      generate_filename_hash
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.file_management.find_existing_month_file" class="md-nav__link">
    <span class="md-ellipsis">
      find_existing_month_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.file_management.estimate_era5_monthly_file_size" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_era5_monthly_file_size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.file_management.estimate_cds_download" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_cds_download
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.file_management.expected_save_stem" class="md-nav__link">
    <span class="md-ellipsis">
      expected_save_stem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.file_management.expected_save_path" class="md-nav__link">
    <span class="md-ellipsis">
      expected_save_path
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.file_management.is_zip_file" class="md-nav__link">
    <span class="md-ellipsis">
      is_zip_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.file_management.is_grib_file" class="md-nav__link">
    <span class="md-ellipsis">
      is_grib_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.file_management.unpack_zip_to_grib" class="md-nav__link">
    <span class="md-ellipsis">
      unpack_zip_to_grib
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utilsloggingpy" class="md-nav__link">
    <span class="md-ellipsis">
      utils/logging.py
    </span>
  </a>
  
    <nav class="md-nav" aria-label="utils/logging.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.logging" class="md-nav__link">
    <span class="md-ellipsis">
      logging
    </span>
  </a>
  
    <nav class="md-nav" aria-label="logging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.logging.build_download_summary" class="md-nav__link">
    <span class="md-ellipsis">
      build_download_summary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.logging.setup_logger" class="md-nav__link">
    <span class="md-ellipsis">
      setup_logger
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.logging.log_msg" class="md-nav__link">
    <span class="md-ellipsis">
      log_msg
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weather_data_retrieval.utils.logging.create_final_log_file" class="md-nav__link">
    <span class="md-ellipsis">
      create_final_log_file
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Usage Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-a-custom-download-script" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a Custom Download Script
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validating-a-config-before-running" class="md-nav__link">
    <span class="md-ellipsis">
      Validating a Config Before Running
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#estimating-download-before-running" class="md-nav__link">
    <span class="md-ellipsis">
      Estimating Download Before Running
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extending-the-package" class="md-nav__link">
    <span class="md-ellipsis">
      Extending the Package
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Extending the Package">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adding-a-new-data-provider" class="md-nav__link">
    <span class="md-ellipsis">
      Adding a New Data Provider
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-new-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Adding New Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-new-configuration-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Adding New Configuration Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    <span class="md-ellipsis">
      Testing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#running-unit-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Running Unit Tests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-individual-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Individual Modules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mock-testing-downloads" class="md-nav__link">
    <span class="md-ellipsis">
      Mock Testing Downloads
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#further-reading" class="md-nav__link">
    <span class="md-ellipsis">
      Further Reading
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Grid Data Retrieval
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Grid Data Retrieval
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../osme-grid-data-retrieval-documentation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../osme-grid-data-retrieval-documentation/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../osme-grid-data-retrieval-documentation/codebase/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Codebase
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Data Cleaning and Joining
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Data Cleaning and Joining
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../osme-data-cleaning-and-joining-documentation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../osme-data-cleaning-and-joining-documentation/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../osme-data-cleaning-and-joining-documentation/codebase/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Codebase
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Marginal Emissions Modelling
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Marginal Emissions Modelling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../osme-marginal-emissions-modelling-documentation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../osme-marginal-emissions-modelling-documentation/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../osme-marginal-emissions-modelling-documentation/codebase/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Codebase
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Shared utilities
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Shared utilities
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../osme-common-utilities-documentation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../osme-common-utilities-documentation/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../osme-common-utilities-documentation/codebase/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Codebase
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="api-reference">API Reference<a class="headerlink" href="#api-reference" title="Permanent link">&para;</a></h1>
<p>This page documents the internal structure of the <code>weather_data_retrieval</code> package. This is useful if you want to understand how the code works, extend it, or integrate it into other tools.</p>
<div class="admonition note">
<p class="admonition-title">For End Users</p>
<p>If you're just using the package to download data, you probably don't need this page. See the <a href="../user-guide/">User Guide</a> or <a href="../quickstart/">Quickstart</a> instead.</p>
</div>
<h2 id="package-structure">Package Structure<a class="headerlink" href="#package-structure" title="Permanent link">&para;</a></h2>
<p>The package is organized into several modules:</p>
<div class="highlight"><pre><span></span><code>weather_data_retrieval/
├── main.py                 # Entry point for CLI
├── runner.py               # Core orchestration logic
├── io/                     # Input/output handling
│   ├── cli.py             # Command-line interface
│   ├── prompts.py         # Interactive wizard prompts
│   └── config_loader.py   # JSON config loading
├── sources/               # Data provider implementations
│   ├── cds_era5.py       # CDS/ERA5 downloader
│   └── open_meteo.py     # Open-Meteo (planned)
└── utils/                 # Shared utilities
    ├── session_management.py  # Session state tracking
    ├── data_validation.py     # Input validation
    ├── file_management.py     # File naming and checking
    └── logging.py             # Logging configuration
</code></pre></div>
<hr />
<h2 id="core-modules">Core Modules<a class="headerlink" href="#core-modules" title="Permanent link">&para;</a></h2>
<h3 id="entry-point-orchestration">Entry Point &amp; Orchestration<a class="headerlink" href="#entry-point-orchestration" title="Permanent link">&para;</a></h3>
<h4 id="mainpy"><code>main.py</code><a class="headerlink" href="#mainpy" title="Permanent link">&para;</a></h4>
<p>The main entry point for the CLI. This is what gets called when you run <code>osme-weather</code>.</p>


<div class="doc doc-object doc-module">



<h4 id="weather_data_retrieval.main" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">weather_data_retrieval.main</span>


<a href="#weather_data_retrieval.main" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents first">

        <p>Main entry point for the Weather Data Retrieval CLI.</p>
<p>This script can be run either:
  - Automatically via a configuration file (<code>--config path/to/config.json</code>), or
  - Interactively through a guided prompt wizard.</p>
<p>It handles session management, logging setup, and orchestration of
the retrieval workflow defined in <code>weather_data_retrieval.runner</code>.</p>
<p>Typically invoked through the CLI command: <code>osme-weather</code> or <code>wdr</code>.</p>










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.main.main" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">main</span>


<a href="#weather_data_retrieval.main.main" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">main</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Entry point for the Weather Data Retrieval CLI.</p>
<p>This function:
  1. Parses CLI arguments or launches the interactive prompt wizard.
  2. Loads or builds a configuration file for weather dataset download.
  3. Initializes logging via <code>osme_common.paths.data_dir()</code>.
  4. Executes the main retrieval workflow using <code>weather_data_retrieval.runner.run</code>.</p>
<p>Automatically invoked by the <code>osme-weather</code> CLI script.</p>


    </div>

</div>



  </div>

    </div>

</div><p><strong>Key Function</strong>: <code>main()</code></p>
<ul>
<li>Parses command-line arguments</li>
<li>Determines run mode (interactive vs. batch)</li>
<li>Sets up logging</li>
<li>Delegates to either the interactive wizard or batch runner</li>
</ul>
<p><strong>Usage</strong>:
<div class="highlight"><pre><span></span><code><span class="c1"># Called automatically by CLI</span>
<span class="c1"># osme-weather [--config FILE] [--verbose] [--quiet]</span>
</code></pre></div></p>
<hr />
<h4 id="runnerpy"><code>runner.py</code><a class="headerlink" href="#runnerpy" title="Permanent link">&para;</a></h4>
<p>Core orchestration logic for the download workflow. This handles validation, estimation, and download coordination.</p>


<div class="doc doc-object doc-module">



<h4 id="weather_data_retrieval.runner" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">weather_data_retrieval.runner</span>


<a href="#weather_data_retrieval.runner" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents first">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.runner.run" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">run</span>


<a href="#weather_data_retrieval.runner.run" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">run</span><span class="p">(</span>
    <span class="n">config</span><span class="p">,</span>
    <span class="n">run_mode</span><span class="o">=</span><span class="s2">&quot;interactive&quot;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Unified orchestration entry point for both interactive and automatic runs.
Handles validation, logging, estimation, and download orchestration.</p>
<p>Returns: 0=success, 1=fatal error, 2=some downloads failed.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration dictionary with all required parameters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>run_mode</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Run mode, either 'interactive' or 'automatic', by default "interactive".</p>
              </div>
            </td>
            <td>
                  <code>&#39;interactive&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger</code>
            </td>
            <td>
                  <code><span title="logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pre-configured logger instance, by default None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exit code: 0=success, 1=fatal error, 2=some downloads failed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.runner.run_batch_from_config" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">run_batch_from_config</span>


<a href="#weather_data_retrieval.runner.run_batch_from_config" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">run_batch_from_config</span><span class="p">(</span><span class="n">cfg_path</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Run automatic batch from a config file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration dictionary with all required parameters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger</code>
            </td>
            <td>
                  <code><span title="logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pre-configured logger instance, by default None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exit code: 0=success, 1=fatal error, 2=some downloads failed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div><p><strong>Key Functions</strong>:</p>
<p><strong><code>run(config, run_mode, verbose, logger)</code></strong></p>
<p>Main workflow orchestrator that:</p>
<ol>
<li>Validates the configuration</li>
<li>Maps config to session state</li>
<li>Performs internet speed test</li>
<li>Estimates download size and time</li>
<li>Generates filename hash</li>
<li>Orchestrates downloads</li>
<li>Reports final statistics</li>
</ol>
<p><strong>Parameters</strong>:
- <code>config</code> (dict): Configuration dictionary
- <code>run_mode</code> (str): <code>"interactive"</code> or <code>"automatic"</code>
- <code>verbose</code> (bool): Whether to echo progress to console
- <code>logger</code> (logging.Logger): Logger instance</p>
<p><strong>Returns</strong>:
- <code>int</code>: Exit code (0=success, 1=fatal error, 2=some failures)</p>
<p><strong><code>run_batch_from_config(cfg_path, logger)</code></strong></p>
<p>Convenience wrapper for batch mode. Loads config and calls <code>run()</code>.</p>
<hr />
<h2 id="inputoutput-modules">Input/Output Modules<a class="headerlink" href="#inputoutput-modules" title="Permanent link">&para;</a></h2>
<h3 id="ioclipy"><code>io/cli.py</code><a class="headerlink" href="#ioclipy" title="Permanent link">&para;</a></h3>
<p>Command-line interface and interactive wizard.</p>


<div class="doc doc-object doc-module">



<h4 id="weather_data_retrieval.io.cli" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">weather_data_retrieval.io.cli</span>


<a href="#weather_data_retrieval.io.cli" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents first">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.io.cli.parse_args" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">parse_args</span>


<a href="#weather_data_retrieval.io.cli.parse_args" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">parse_args</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Parse command-line arguments.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>None</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="argparse.Namespace">Namespace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Parsed arguments.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.io.cli.run_prompt_wizard" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">run_prompt_wizard</span>


<a href="#weather_data_retrieval.io.cli.run_prompt_wizard" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">run_prompt_wizard</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Drives the interactive prompt flow (no config-source step).
Returns True if all fields completed; False if user exits.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SessionState (weather_data_retrieval.utils.session_management.SessionState)" href="#weather_data_retrieval.utils.session_management.SessionState">SessionState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The session state to populate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger</code>
            </td>
            <td>
                  <code><span title="logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Logger for logging messages, by default None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if completed; False if exited early.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div><p><strong>Key Functions</strong>:</p>
<p><strong><code>parse_args()</code></strong></p>
<p>Parses command-line arguments using argparse.</p>
<p><strong>Returns</strong>: <code>argparse.Namespace</code> with fields:
- <code>config</code>: Path to config file (if <code>--config</code> provided)
- <code>verbose</code>: Boolean for verbose output (batch mode)
- <code>quiet</code>: Boolean for quiet mode (interactive mode)</p>
<p><strong><code>run_prompt_wizard(session, logger)</code></strong></p>
<p>Drives the interactive prompt flow. Steps through each configuration parameter, validates inputs, and handles back/exit commands.</p>
<p><strong>Parameters</strong>:
- <code>session</code> (SessionState): Session state to populate
- <code>logger</code> (logging.Logger): Logger instance</p>
<p><strong>Returns</strong>:
- <code>bool</code>: <code>True</code> if completed successfully, <code>False</code> if user exited early</p>
<hr />
<h3 id="iopromptspy"><code>io/prompts.py</code><a class="headerlink" href="#iopromptspy" title="Permanent link">&para;</a></h3>
<p>Individual prompt functions for each configuration step.</p>


<div class="doc doc-object doc-module">



<h4 id="weather_data_retrieval.io.prompts" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">weather_data_retrieval.io.prompts</span>


<a href="#weather_data_retrieval.io.prompts" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents first">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.io.prompts.read_input" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">read_input</span>


<a href="#weather_data_retrieval.io.prompts.read_input" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">read_input</span><span class="p">(</span><span class="n">prompt</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Centralized input handler with built-in 'exit' and 'back' controls.</p>


<details class="parameters:" open>
  <summary>Parameters:</summary>
  <p>prompt : str
    The prompt to display to the user.
logger : logging.Logger, optional
    Logger to log the prompt message.</p>
</details>

<details class="returns:" open>
  <summary>Returns:</summary>
  <p>str
    The user input, or special command indicators.</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.io.prompts.say" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">say</span>


<a href="#weather_data_retrieval.io.prompts.say" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">say</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Centralized output handler to log and print messages.</p>


<details class="parameters:" open>
  <summary>Parameters:</summary>
  <p>text : str
    The message to display.
logger : logging.Logger, optional
    Logger to log the message.</p>
</details>

<details class="returns:" open>
  <summary>Returns:</summary>
  <p>None</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.io.prompts.prompt_data_provider" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">prompt_data_provider</span>


<a href="#weather_data_retrieval.io.prompts.prompt_data_provider" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">prompt_data_provider</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Prompt user for which data provider to use (CDS or Open-Meteo).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SessionState (weather_data_retrieval.utils.session_management.SessionState)" href="#weather_data_retrieval.utils.session_management.SessionState">SessionState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current session state to store selected data provider.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger</code>
            </td>
            <td>
                  <code><span title="logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Logger for logging messages, by default None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Normalized provider name ("cds" or "open-meteo"),
or special control token "<strong>BACK</strong>" or "<strong>EXIT</strong>".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.io.prompts.prompt_dataset_short_name" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">prompt_dataset_short_name</span>


<a href="#weather_data_retrieval.io.prompts.prompt_dataset_short_name" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">prompt_dataset_short_name</span><span class="p">(</span>
    <span class="n">session</span><span class="p">,</span> <span class="n">provider</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Prompt for dataset choice.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SessionState (weather_data_retrieval.utils.session_management.SessionState)" href="#weather_data_retrieval.utils.session_management.SessionState">SessionState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current session state to store selected dataset.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>provider</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data provider name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger</code>
            </td>
            <td>
                  <code><span title="logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Logger for logging messages, by default None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>    str: Normalized dataset name or &#39;exit&#39; / &#39;back&#39;.</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.io.prompts.prompt_cds_url" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">prompt_cds_url</span>


<a href="#weather_data_retrieval.io.prompts.prompt_cds_url" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">prompt_cds_url</span><span class="p">(</span>
    <span class="n">session</span><span class="p">,</span>
    <span class="n">api_url_default</span><span class="o">=</span><span class="s2">&quot;https://cds.climate.copernicus.eu/api&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">logger</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Prompt for CDS API URL.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SessionState (weather_data_retrieval.utils.session_management.SessionState)" href="#weather_data_retrieval.utils.session_management.SessionState">SessionState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current session state to store API URL.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>api_url_default</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Default CDS API URL. https://cds.climate.copernicus.eu/api</p>
              </div>
            </td>
            <td>
                  <code>&#39;https://cds.climate.copernicus.eu/api&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>    str: CDS API URL or &#39;exit&#39; / &#39;back&#39;.</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.io.prompts.prompt_cds_api_key" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">prompt_cds_api_key</span>


<a href="#weather_data_retrieval.io.prompts.prompt_cds_api_key" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">prompt_cds_api_key</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Prompt only for the CDS API key (hidden input).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SessionState (weather_data_retrieval.utils.session_management.SessionState)" href="#weather_data_retrieval.utils.session_management.SessionState">SessionState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current session state to store API key.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger</code>
            </td>
            <td>
                  <code><span title="logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Logger for logging messages, by default None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>CDS API key or 'exit' / 'back'.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.io.prompts.prompt_save_directory" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">prompt_save_directory</span>


<a href="#weather_data_retrieval.io.prompts.prompt_save_directory" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">prompt_save_directory</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">default_dir</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Ask for save directory, create if necessary.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SessionState (weather_data_retrieval.utils.session_management.SessionState)" href="#weather_data_retrieval.utils.session_management.SessionState">SessionState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current session state to store save directory.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_dir</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Default directory to suggest.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger</code>
            </td>
            <td>
                  <code><span title="logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Logger for logging messages, by default None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pathlib.Path">Path</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to save directory, or control token "<strong>BACK</strong>" / "<strong>EXIT</strong>".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.io.prompts.prompt_date_range" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">prompt_date_range</span>


<a href="#weather_data_retrieval.io.prompts.prompt_date_range" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">prompt_date_range</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Ask user for start and end date, with validation.
Accepts formats: YYYY-MM-DD or YYYY-MM
- Start dates without day default to first day of month (YYYY-MM-01)
- End dates without day default to last day of month (YYYY-MM-[last day])</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SessionState (weather_data_retrieval.utils.session_management.SessionState)" href="#weather_data_retrieval.utils.session_management.SessionState">SessionState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current session state to store date range.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger</code>
            </td>
            <td>
                  <code><span title="logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Logger for logging messages, by default None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(start_date_str, end_date_str) in ISO format (YYYY-MM-DD),
or ("<strong>EXIT</strong>", "<strong>EXIT</strong>") / ("<strong>BACK</strong>", "<strong>BACK</strong>")</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.io.prompts.prompt_coordinates" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">prompt_coordinates</span>


<a href="#weather_data_retrieval.io.prompts.prompt_coordinates" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">prompt_coordinates</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Prompt user for geographic boundaries (N, S, W, E) with validation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SessionState (weather_data_retrieval.utils.session_management.SessionState)" href="#weather_data_retrieval.utils.session_management.SessionState">SessionState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current session state to store geographic boundaries.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>[north, west, south, east] boundaries or special tokens "<strong>EXIT</strong>" / "<strong>BACK</strong>".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.io.prompts.prompt_variables" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">prompt_variables</span>


<a href="#weather_data_retrieval.io.prompts.prompt_variables" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">prompt_variables</span><span class="p">(</span>
    <span class="n">session</span><span class="p">,</span>
    <span class="n">variable_restrictions_list</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="n">restriction_allow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">logger</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Ask for variables to download, validate each against allowed/disallowed list,
and only update session if the full set is valid.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SessionState (weather_data_retrieval.utils.session_management.SessionState)" href="#weather_data_retrieval.utils.session_management.SessionState">SessionState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current session state to store selected variables.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>variable_restrictions_list</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of variables that are either allowed or disallowed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>restriction_allow</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, variable_restrictions_list is an allowlist (i.e. in).
If False, it's a denylist (i.e. not in)</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger</code>
            </td>
            <td>
                  <code><span title="logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Logger for logging messages, by default None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of selected variable names, or control token "<strong>BACK</strong>" / "<strong>EXIT</strong>".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.io.prompts.prompt_skip_overwrite_files" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">prompt_skip_overwrite_files</span>


<a href="#weather_data_retrieval.io.prompts.prompt_skip_overwrite_files" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">prompt_skip_overwrite_files</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Prompt user to choose skip/overwrite/case-by-case for existing files.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SessionState (weather_data_retrieval.utils.session_management.SessionState)" href="#weather_data_retrieval.utils.session_management.SessionState">SessionState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Session state to store user choice.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger</code>
            </td>
            <td>
                  <code><span title="logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Logger for logging messages, by default None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>One of "overwrite_all", "skip_all", "case_by_case"</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.io.prompts.prompt_parallelisation_settings" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">prompt_parallelisation_settings</span>


<a href="#weather_data_retrieval.io.prompts.prompt_parallelisation_settings" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">prompt_parallelisation_settings</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Ask user about parallel downloads and concurrency cap.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SessionState (weather_data_retrieval.utils.session_management.SessionState)" href="#weather_data_retrieval.utils.session_management.SessionState">SessionState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current session state to store parallelisation settings.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger</code>
            </td>
            <td>
                  <code><span title="logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Logger for logging messages, by default None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with parallelisation settings, or control token "<strong>BACK</strong>" / "<strong>EXIT</strong>".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.io.prompts.prompt_retry_settings" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">prompt_retry_settings</span>


<a href="#weather_data_retrieval.io.prompts.prompt_retry_settings" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">prompt_retry_settings</span><span class="p">(</span>
    <span class="n">session</span><span class="p">,</span>
    <span class="n">default_retries</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
    <span class="n">default_delay</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">logger</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Ask user for retry limits.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SessionState (weather_data_retrieval.utils.session_management.SessionState)" href="#weather_data_retrieval.utils.session_management.SessionState">SessionState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current session state to store retry settings.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_retries</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Default number of retry attempts (default = 6).</p>
              </div>
            </td>
            <td>
                  <code>6</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_delay</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Default delay (in seconds) between retries (default = 15).</p>
              </div>
            </td>
            <td>
                  <code>15</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger</code>
            </td>
            <td>
                  <code><span title="logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Logger for logging messages, by default None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with 'max_retries' and 'retry_delay_sec', or control token "<strong>BACK</strong>" / "<strong>EXIT</strong>".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.io.prompts.prompt_continue_confirmation" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">prompt_continue_confirmation</span>


<a href="#weather_data_retrieval.io.prompts.prompt_continue_confirmation" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">prompt_continue_confirmation</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Display a formatted download summary and confirm before starting downloads.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SessionState (weather_data_retrieval.utils.session_management.SessionState)" href="#weather_data_retrieval.utils.session_management.SessionState">SessionState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>session state to summarise.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger</code>
            </td>
            <td>
                  <code><span title="logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Logger for logging messages, by default None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if user confirms, False if user declines,
or control token "<strong>BACK</strong>" / "<strong>EXIT</strong>".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div><p><strong>Key Functions</strong>:</p>
<p>Each prompt function handles user input for a specific configuration parameter:</p>
<ul>
<li><code>prompt_data_provider()</code> - Choose CDS or Open-Meteo</li>
<li><code>prompt_dataset_short_name()</code> - Choose ERA5-Land or ERA5</li>
<li><code>prompt_cds_url()</code> - CDS API URL</li>
<li><code>prompt_cds_api_key()</code> - CDS API key</li>
<li><code>prompt_date_range()</code> - Start and end dates</li>
<li><code>prompt_coordinates()</code> - Region bounds [N, W, S, E]</li>
<li><code>prompt_variables()</code> - Variable selection</li>
<li><code>prompt_skip_overwrite_files()</code> - Existing file handling</li>
<li><code>prompt_parallelisation_settings()</code> - Parallel download settings</li>
<li><code>prompt_retry_settings()</code> - Retry configuration</li>
<li><code>prompt_continue_confirmation()</code> - Final review and confirmation</li>
</ul>
<p>All prompt functions follow the same pattern:</p>
<p><strong>Parameters</strong>:
- <code>session</code> (SessionState): Current session state
- <code>logger</code> (logging.Logger): Logger instance
- <code>echo_console</code> (bool): Whether to echo to console</p>
<p><strong>Returns</strong>: 
- The validated input value, or
- <code>"__EXIT__"</code> if user wants to quit, or
- <code>"__BACK__"</code> if user wants to go to previous prompt</p>
<hr />
<h3 id="ioconfig_loaderpy"><code>io/config_loader.py</code><a class="headerlink" href="#ioconfig_loaderpy" title="Permanent link">&para;</a></h3>
<p>JSON configuration file loading and validation.</p>


<div class="doc doc-object doc-module">



<h4 id="weather_data_retrieval.io.config_loader" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">weather_data_retrieval.io.config_loader</span>


<a href="#weather_data_retrieval.io.config_loader" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents first">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.io.config_loader.load_and_validate_config" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">load_and_validate_config</span>


<a href="#weather_data_retrieval.io.config_loader.load_and_validate_config" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">load_and_validate_config</span><span class="p">(</span>
    <span class="n">path</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">run_mode</span><span class="o">=</span><span class="s2">&quot;automatic&quot;</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Load JSON config and validate it using the centralized validator.
This lets the validator log coercions/warnings (e.g., case_by_case → skip_all).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to JSON config file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger</code>
            </td>
            <td>
                  <code><span title="logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Logger instance for validation messages, by default None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>run_mode</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Run mode, either 'interactive' or 'automatic', by default "automatic".</p>
              </div>
            </td>
            <td>
                  <code>&#39;automatic&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Validated configuration dictionary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.io.config_loader.load_config" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">load_config</span>


<a href="#weather_data_retrieval.io.config_loader.load_config" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">load_config</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Load configuration from a JSON requirements file (without validation).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>file_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to JSON config file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration dictionary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div><p><strong>Key Functions</strong>:</p>
<p><strong><code>load_and_validate_config(path, logger, run_mode)</code></strong></p>
<p>Loads a JSON config file and validates it.</p>
<p><strong>Parameters</strong>:
- <code>path</code> (str): Path to JSON config file
- <code>logger</code> (logging.Logger, optional): Logger for validation messages
- <code>run_mode</code> (str): <code>"interactive"</code> or <code>"automatic"</code></p>
<p><strong>Returns</strong>:
- <code>dict</code>: Validated configuration</p>
<p><strong>Raises</strong>:
- <code>FileNotFoundError</code>: If config file doesn't exist
- <code>ValueError</code>: If config is invalid</p>
<p><strong><code>load_config(file_path)</code></strong></p>
<p>Simple config loader without validation (for internal use).</p>
<hr />
<h2 id="data-provider-modules">Data Provider Modules<a class="headerlink" href="#data-provider-modules" title="Permanent link">&para;</a></h2>
<h3 id="sourcescds_era5py"><code>sources/cds_era5.py</code><a class="headerlink" href="#sourcescds_era5py" title="Permanent link">&para;</a></h3>
<p>CDS/ERA5 data provider implementation.</p>


<div class="doc doc-object doc-module">



<h4 id="weather_data_retrieval.sources.cds_era5" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">weather_data_retrieval.sources.cds_era5</span>


<a href="#weather_data_retrieval.sources.cds_era5" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents first">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.sources.cds_era5.prepare_cds_download" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">prepare_cds_download</span>


<a href="#weather_data_retrieval.sources.cds_era5.prepare_cds_download" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">prepare_cds_download</span><span class="p">(</span>
    <span class="n">session</span><span class="p">,</span>
    <span class="n">filename_base</span><span class="p">,</span>
    <span class="n">year</span><span class="p">,</span>
    <span class="n">month</span><span class="p">,</span>
    <span class="n">save_dir</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">logger</span><span class="p">,</span>
    <span class="n">echo_console</span><span class="p">,</span>
    <span class="n">allow_prompts</span><span class="p">,</span>
    <span class="n">dataset_config_mapping</span><span class="o">=</span><span class="n">CDS_DATASETS</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check if a monthly ERA5 file already exists and decide whether to download.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SessionState (weather_data_retrieval.utils.session_management.SessionState)" href="#weather_data_retrieval.utils.session_management.SessionState">SessionState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Session containing user configuration.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filename_base</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base name for the file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>year</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Year of the data to download.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>month</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Month of the data to download.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_dir</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory to save downloaded files.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger</code>
            </td>
            <td>
                  <code><span title="logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Logger for logging messages.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>echo_console</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to echo prompts to console.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>allow_prompts</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to allow interactive prompts.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset_config_mapping</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mapping of dataset short names to their configurations.</p>
              </div>
            </td>
            <td>
                  <code><span title="weather_data_retrieval.utils.data_validation.CDS_DATASETS">CDS_DATASETS</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
                  <code>(download: bool, save_path: str)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>download: Whether to perform the download.
save_path: Full path for the target file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.sources.cds_era5.execute_cds_download" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">execute_cds_download</span>


<a href="#weather_data_retrieval.sources.cds_era5.execute_cds_download" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">execute_cds_download</span><span class="p">(</span>
    <span class="n">session</span><span class="p">,</span>
    <span class="n">save_path</span><span class="p">,</span>
    <span class="n">year</span><span class="p">,</span>
    <span class="n">month</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">logger</span><span class="p">,</span>
    <span class="n">echo_console</span><span class="p">,</span>
    <span class="n">dataset_config_mapping</span><span class="o">=</span><span class="n">CDS_DATASETS</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Execute a single ERA5 monthly download with retry logic.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SessionState (weather_data_retrieval.utils.session_management.SessionState)" href="#weather_data_retrieval.utils.session_management.SessionState">SessionState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Session state containing the authenticated CDS API client.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Full path to save the downloaded file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>year</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Year of the data to download.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>month</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Month of the data to download.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger</code>
            </td>
            <td>
                  <code><span title="logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Logger for logging messages.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>echo_console</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to echo prompts to console.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset_config_mapping</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mapping of dataset short names to their configurations.</p>
              </div>
            </td>
            <td>
                  <code><span title="weather_data_retrieval.utils.data_validation.CDS_DATASETS">CDS_DATASETS</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>(year, month, status): tuple</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>status = "success" | "failed"</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.sources.cds_era5.download_cds_month" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">download_cds_month</span>


<a href="#weather_data_retrieval.sources.cds_era5.download_cds_month" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">download_cds_month</span><span class="p">(</span>
    <span class="n">session</span><span class="p">,</span>
    <span class="n">filename_base</span><span class="p">,</span>
    <span class="n">year</span><span class="p">,</span>
    <span class="n">month</span><span class="p">,</span>
    <span class="n">save_dir</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">logger</span><span class="p">,</span>
    <span class="n">echo_console</span><span class="p">,</span>
    <span class="n">allow_prompts</span><span class="p">,</span>
    <span class="n">successful_downloads</span><span class="p">,</span>
    <span class="n">failed_downloads</span><span class="p">,</span>
    <span class="n">skipped_downloads</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Orchestrate ERA5 monthly download: handle file checks, then execute download.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>Combines</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>(year, month, status): tuple</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>status = "success" | "failed" | "skipped"</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.sources.cds_era5.plan_cds_months" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">plan_cds_months</span>


<a href="#weather_data_retrieval.sources.cds_era5.plan_cds_months" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plan_cds_months</span><span class="p">(</span>
    <span class="n">session</span><span class="p">,</span>
    <span class="n">filename_base</span><span class="p">,</span>
    <span class="n">save_dir</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">logger</span><span class="p">,</span>
    <span class="n">echo_console</span><span class="p">,</span>
    <span class="n">allow_prompts</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Build the list of months to download and which are being skipped due to existing files.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SessionState (weather_data_retrieval.utils.session_management.SessionState)" href="#weather_data_retrieval.utils.session_management.SessionState">SessionState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Session containing user configuration.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filename_base</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base filename (without date or extension).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_dir</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory to save downloaded files.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger</code>
            </td>
            <td>
                  <code><span title="logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Logger for logging messages.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>echo_console</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to echo prompts to console.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>allow_prompts</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to allow interactive prompts.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>(<span title="months_to_download">months_to_download</span>, <span title="months_skipped">months_skipped</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>months_to_download: list[(year, month)]</li>
<li>months_skipped: list[(year, month, path)]</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.sources.cds_era5.orchestrate_cds_downloads" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">orchestrate_cds_downloads</span>


<a href="#weather_data_retrieval.sources.cds_era5.orchestrate_cds_downloads" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">orchestrate_cds_downloads</span><span class="p">(</span>
    <span class="n">session</span><span class="p">,</span>
    <span class="n">filename_base</span><span class="p">,</span>
    <span class="n">save_dir</span><span class="p">,</span>
    <span class="n">successful_downloads</span><span class="p">,</span>
    <span class="n">failed_downloads</span><span class="p">,</span>
    <span class="n">skipped_downloads</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">logger</span><span class="p">,</span>
    <span class="n">echo_console</span><span class="p">,</span>
    <span class="n">allow_prompts</span><span class="p">,</span>
    <span class="n">dataset_config_mapping</span><span class="o">=</span><span class="n">CDS_DATASETS</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Handle and orchestrate ERA5 monthly downloads, supporting parallel or sequential execution.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SessionState (weather_data_retrieval.utils.session_management.SessionState)" href="#weather_data_retrieval.utils.session_management.SessionState">SessionState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Session containing user configuration and authenticated client.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filename_base</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base filename (without date or extension).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_dir</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory to save downloaded files.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>successful_downloads</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mutable list to collect (year, month) tuples for successful downloads.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>failed_downloads</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mutable list to collect (year, month) tuples for failed downloads.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>skipped_downloads</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mutable list to collect (year, month) tuples for skipped downloads.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger</code>
            </td>
            <td>
                  <code><span title="logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Logger for logging messages.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>echo_console</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to echo prompts to console.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>allow_prompts</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to allow interactive prompts.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset_config_mapping</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mapping of dataset configurations, by default CDS_DATASETS.</p>
              </div>
            </td>
            <td>
                  <code><span title="weather_data_retrieval.utils.data_validation.CDS_DATASETS">CDS_DATASETS</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div><p><strong>Key Functions</strong>:</p>
<p><strong><code>orchestrate_cds_downloads(session, filename_base, save_dir, ...)</code></strong></p>
<p>Manages the entire CDS download workflow:</p>
<ol>
<li>Generates list of months to download</li>
<li>Checks for existing files (skip logic)</li>
<li>Coordinates parallel or sequential downloads</li>
<li>Handles retries and failures</li>
<li>Validates downloaded files</li>
<li>Updates success/failure lists</li>
</ol>
<p><strong>Parameters</strong>:
- <code>session</code> (SessionState): Current session with all parameters
- <code>filename_base</code> (str): Base filename for output files
- <code>save_dir</code> (Path): Directory to save files
- <code>successful_downloads</code> (list): List to append successful months
- <code>failed_downloads</code> (list): List to append failed months
- <code>skipped_downloads</code> (list): List to append skipped months
- <code>logger</code> (logging.Logger): Logger instance
- <code>echo_console</code> (bool): Whether to echo progress
- <code>allow_prompts</code> (bool): Whether prompts are allowed (interactive mode)</p>
<p><strong><code>download_monthly_era5_file(...)</code></strong></p>
<p>Downloads a single month of ERA5 data.</p>
<p><strong>Parameters</strong>:
- <code>client</code> (cdsapi.Client): Authenticated CDS client
- <code>dataset_full_name</code> (str): Full CDS dataset name
- <code>year</code> (int): Year to download
- <code>month</code> (int): Month to download
- <code>variables</code> (list): Variables to request
- <code>region_bounds</code> (list): Geographic bounds [N, W, S, E]
- <code>output_file</code> (Path): Where to save the file
- Various retry and logging parameters</p>
<p><strong>Returns</strong>:
- <code>Path</code>: Path to downloaded file if successful, else <code>None</code></p>
<hr />
<h3 id="sourcesopen_meteopy"><code>sources/open_meteo.py</code><a class="headerlink" href="#sourcesopen_meteopy" title="Permanent link">&para;</a></h3>
<p>Open-Meteo data provider (planned, not yet implemented).</p>


<div class="doc doc-object doc-module">



<h4 id="weather_data_retrieval.sources.open_meteo" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">weather_data_retrieval.sources.open_meteo</span>


<a href="#weather_data_retrieval.sources.open_meteo" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents first">








    </div>

</div><div class="admonition info">
<p class="admonition-title">Coming Soon</p>
<p>This module is a placeholder for future Open-Meteo integration.</p>
</div>
<hr />
<h2 id="utility-modules">Utility Modules<a class="headerlink" href="#utility-modules" title="Permanent link">&para;</a></h2>
<h3 id="utilssession_managementpy"><code>utils/session_management.py</code><a class="headerlink" href="#utilssession_managementpy" title="Permanent link">&para;</a></h3>
<p>Session state tracking and management.</p>


<div class="doc doc-object doc-module">



<h4 id="weather_data_retrieval.utils.session_management" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">weather_data_retrieval.utils.session_management</span>


<a href="#weather_data_retrieval.utils.session_management" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents first">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h5 id="weather_data_retrieval.utils.session_management.SessionState" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">SessionState</span>


<a href="#weather_data_retrieval.utils.session_management.SessionState" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">












  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h6 id="weather_data_retrieval.utils.session_management.SessionState.first_unfilled_key" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">first_unfilled_key</span>


<a href="#weather_data_retrieval.utils.session_management.SessionState.first_unfilled_key" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">first_unfilled_key</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return the first key in the ordered fields that is not filled.
This enables a simple wizard-like progression and supports
backtracking by clearing fields with <code>unset(key)</code>.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="weather_data_retrieval.utils.session_management.SessionState.summary" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">summary</span>


<a href="#weather_data_retrieval.utils.session_management.SessionState.summary" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">summary</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return a nice printable summary of all fields in a tabular format.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="weather_data_retrieval.utils.session_management.SessionState.to_dict" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">to_dict</span>


<a href="#weather_data_retrieval.utils.session_management.SessionState.to_dict" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">to_dict</span><span class="p">(</span><span class="n">only_filled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Flatten the session into a plain dict suitable for runner.run(...).
If only_filled=True, include only keys that have been filled.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>only_filled</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to include only filled keys, by default False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flattened session dictionary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.session_management.get_cds_dataset_config" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_cds_dataset_config</span>


<a href="#weather_data_retrieval.utils.session_management.get_cds_dataset_config" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_cds_dataset_config</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">dataset_config_mapping</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return dataset configuration dictionary based on session short name.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SessionState (weather_data_retrieval.utils.session_management.SessionState)" href="#weather_data_retrieval.utils.session_management.SessionState">SessionState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current session state containing user selections.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset_config_mapping</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The mapping of dataset short names to their configurations.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The configuration dictionary for the selected dataset.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.session_management.map_config_to_session" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">map_config_to_session</span>


<a href="#weather_data_retrieval.utils.session_management.map_config_to_session" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">map_config_to_session</span><span class="p">(</span>
    <span class="n">cfg</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">echo_console</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Validate and map a loaded JSON config into SessionState.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cfg</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Loaded configuration dictionary.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>session</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SessionState (weather_data_retrieval.utils.session_management.SessionState)" href="#weather_data_retrieval.utils.session_management.SessionState">SessionState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The session state to populate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="returns:" open>
  <summary>Returns:</summary>
  <p>tuple : (bool, list[str])
    (ok, messages): ok=False if any hard error prevents continuing.</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.session_management.ensure_cds_connection" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">ensure_cds_connection</span>


<a href="#weather_data_retrieval.utils.session_management.ensure_cds_connection" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">ensure_cds_connection</span><span class="p">(</span>
    <span class="n">client</span><span class="p">,</span>
    <span class="n">creds</span><span class="p">,</span>
    <span class="n">max_reauth_attempts</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
    <span class="n">wait_between_attempts</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Ensure a valid CDS API client. Re-authenticate automatically if the connection drops.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="cdsapi.Client">Client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current CDS API client.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>creds</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>{'url': str, 'key': str} stored from initial login.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_reauth_attempts</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum reconnection attempts before aborting.</p>
              </div>
            </td>
            <td>
                  <code>6</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wait_between_attempts</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Wait time (seconds) between re-auth attempts.</p>
              </div>
            </td>
            <td>
                  <code>15</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="cdsapi.Client">Client</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Valid client or None if re-authentication ultimately fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.session_management.internet_speedtest" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">internet_speedtest</span>


<a href="#weather_data_retrieval.utils.session_management.internet_speedtest" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">internet_speedtest</span><span class="p">(</span>
    <span class="n">test_urls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">max_seconds</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">echo_console</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Download ~100MB test file from a fast CDN to estimate speed (MB/s).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>test_urls</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of URLs of the test files.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_seconds</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum time to wait for a response, by default 15 seconds.</p>
              </div>
            </td>
            <td>
                  <code>15</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>    float: Estimated download speed in Mbps.</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div><p><strong>Key Classes</strong>:</p>
<p><strong><code>SessionState</code></strong></p>
<p>A simple key-value store for tracking configuration state during interactive sessions.</p>
<p><strong>Methods</strong>:
- <code>get(key, default=None)</code> - Retrieve a value
- <code>set(key, value)</code> - Store a value
- <code>unset(key)</code> - Remove a value
- <code>first_unfilled_key()</code> - Get the next required key that hasn't been set
- <code>to_dict()</code> - Convert session to a dictionary (for saving)</p>
<p><strong>Usage</strong>:
<div class="highlight"><pre><span></span><code><span class="n">session</span> <span class="o">=</span> <span class="n">SessionState</span><span class="p">()</span>
<span class="n">session</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;data_provider&quot;</span><span class="p">,</span> <span class="s2">&quot;cds&quot;</span><span class="p">)</span>
<span class="n">session</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;dataset_short_name&quot;</span><span class="p">,</span> <span class="s2">&quot;era5-land&quot;</span><span class="p">)</span>

<span class="n">provider</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data_provider&quot;</span><span class="p">)</span>  <span class="c1"># &quot;cds&quot;</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>  <span class="c1"># {&quot;data_provider&quot;: &quot;cds&quot;, ...}</span>
</code></pre></div></p>
<p><strong>Key Functions</strong>:</p>
<p><strong><code>internet_speedtest(test_urls, max_seconds, logger, echo_console)</code></strong></p>
<p>Performs a quick internet speed test to estimate download times.</p>
<p><strong>Parameters</strong>:
- <code>test_urls</code> (list, optional): URLs to test (uses defaults if None)
- <code>max_seconds</code> (int): Maximum time to spend testing
- <code>logger</code> (logging.Logger): Logger instance
- <code>echo_console</code> (bool): Whether to echo results</p>
<p><strong>Returns</strong>:
- <code>float</code>: Estimated speed in Mbps</p>
<p><strong><code>map_config_to_session(config, session, logger, echo_console)</code></strong></p>
<p>Maps a configuration dictionary to a SessionState, validating as it goes.</p>
<hr />
<h3 id="utilsdata_validationpy"><code>utils/data_validation.py</code><a class="headerlink" href="#utilsdata_validationpy" title="Permanent link">&para;</a></h3>
<p>Input validation functions.</p>


<div class="doc doc-object doc-module">



<h4 id="weather_data_retrieval.utils.data_validation" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">weather_data_retrieval.utils.data_validation</span>


<a href="#weather_data_retrieval.utils.data_validation" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents first">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.data_validation.normalize_input" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">normalize_input</span>


<a href="#weather_data_retrieval.utils.data_validation.normalize_input" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">normalize_input</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">category</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Normalize user input to canonical internal value as defined in NORMALIZATION_MAP.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>value</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The user input value to normalize.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>category</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The category of normalization (e.g., 'data_provider', 'dataset_short_name')</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The normalized value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.data_validation.format_duration" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">format_duration</span>


<a href="#weather_data_retrieval.utils.data_validation.format_duration" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">format_duration</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert seconds to a nice Hh Mm Ss string (with decimal seconds).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>seconds</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Duration in seconds.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>    str: Formatted duration string.</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.data_validation.format_coordinates_nwse" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">format_coordinates_nwse</span>


<a href="#weather_data_retrieval.utils.data_validation.format_coordinates_nwse" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">format_coordinates_nwse</span><span class="p">(</span><span class="n">boundaries</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Extracts and formats coordinates as integers in N-W-S-E order
Used for compact representation in filenames.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>boundaries</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of boundaries in the order [north, west, south, east]</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>    str: Formatted string in the format &#39;N{north}W{west}S{south}E{east}&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.data_validation.month_days" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">month_days</span>


<a href="#weather_data_retrieval.utils.data_validation.month_days" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">month_days</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get list of days in a month formatted as two-digit strings.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>year</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Year of interest.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>month</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Month of interest.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of days in the month as two-digit strings.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.data_validation.validate_data_provider" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">validate_data_provider</span>


<a href="#weather_data_retrieval.utils.data_validation.validate_data_provider" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">validate_data_provider</span><span class="p">(</span><span class="n">provider</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Ensure dataprovider is recognized and implemented.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>provider</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the data provider.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>    bool: True if valid, False otherwise.</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.data_validation.validate_dataset_short_name" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">validate_dataset_short_name</span>


<a href="#weather_data_retrieval.utils.data_validation.validate_dataset_short_name" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">validate_dataset_short_name</span><span class="p">(</span>
    <span class="n">dataset_short_name</span><span class="p">,</span>
    <span class="n">provider</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">echo_console</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check dataset compatibility with provider.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset_short_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataset short name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>provider</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the data provider.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if valid, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.data_validation.validate_cds_api_key" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">validate_cds_api_key</span>


<a href="#weather_data_retrieval.utils.data_validation.validate_cds_api_key" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">validate_cds_api_key</span><span class="p">(</span>
    <span class="n">url</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">echo_console</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Validate CDS API credentials by attempting to initialize a cdsapi.Client.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>url</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>CDS API URL.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>CDS API key.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger</code>
            </td>
            <td>
                  <code><span title="weather_data_retrieval.utils.logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Logger for logging messages, by default None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>echo_console</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to echo messages to console, by default False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="cdsapi.Client">Client</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Authenticated client if successful, otherwise None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.data_validation.validate_directory" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">validate_directory</span>


<a href="#weather_data_retrieval.utils.data_validation.validate_directory" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">validate_directory</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check if path exists or can be created.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory path to validate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if path exists or was created successfully, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.data_validation.validate_date" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">validate_date</span>


<a href="#weather_data_retrieval.utils.data_validation.validate_date" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">validate_date</span><span class="p">(</span>
    <span class="n">value</span><span class="p">,</span>
    <span class="n">allow_month_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">echo_console</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Validate date format as YYYY-MM-DD or optionally YYYY-MM.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>value</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Date string to validate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>allow_month_only</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, also accept YYYY-MM format, by default False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if valid, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.data_validation.parse_date_with_defaults" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">parse_date_with_defaults</span>


<a href="#weather_data_retrieval.utils.data_validation.parse_date_with_defaults" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">parse_date_with_defaults</span><span class="p">(</span>
    <span class="n">date_str</span><span class="p">,</span> <span class="n">default_to_month_end</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Parse date string and apply defaults for incomplete dates.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>date_str</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Date string in format YYYY-MM-DD or YYYY-MM.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_to_month_end</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True and date is YYYY-MM format, default to last day of month.
If False and date is YYYY-MM format, default to first day of month.
By default False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="datetime.datetime">datetime</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of (parsed datetime object, ISO format string YYYY-MM-DD)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If date string is invalid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.data_validation.clamp_era5_available_end_date" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">clamp_era5_available_end_date</span>


<a href="#weather_data_retrieval.utils.data_validation.clamp_era5_available_end_date" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">clamp_era5_available_end_date</span><span class="p">(</span>
    <span class="n">end</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">echo_console</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Clamp end date to ERA5 data availability boundary (8 days ago).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>end</code>
            </td>
            <td>
                  <code><span title="datetime.datetime">datetime</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Desired end date.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code>    datetime: Clamped end date.</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>NOTES</code></td>            <td>
                  <code>ERA5 data is available up to 8 days prior to the current date.</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code>8-day lag is used to ensure data availability.</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.data_validation.validate_coordinates" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">validate_coordinates</span>


<a href="#weather_data_retrieval.utils.data_validation.validate_coordinates" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">validate_coordinates</span><span class="p">(</span><span class="n">north</span><span class="p">,</span> <span class="n">west</span><span class="p">,</span> <span class="n">south</span><span class="p">,</span> <span class="n">east</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Ensure coordinates are within realistic bounds.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>north</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Northern latitude boundary.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>west</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Western longitude boundary.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>south</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Southern latitude boundary.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>east</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Eastern longitude boundary.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if coordinates are valid, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.data_validation.validate_variables" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">validate_variables</span>


<a href="#weather_data_retrieval.utils.data_validation.validate_variables" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">validate_variables</span><span class="p">(</span>
    <span class="n">variable_list</span><span class="p">,</span>
    <span class="n">variable_restrictions</span><span class="p">,</span>
    <span class="n">restriction_allow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Ensure user-specified variables are available for this dataset.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>variable_list</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of variable names to validate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>variable_restrictions</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of variables that are either allowed or disallowed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>restriction_allow</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, variable_restrictions is an allowlist (i.e. in). If False, it's a denylist
(i.e. not in)</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if all variables are valid, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.data_validation.validate_existing_file_action" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">validate_existing_file_action</span>


<a href="#weather_data_retrieval.utils.data_validation.validate_existing_file_action" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">validate_existing_file_action</span><span class="p">(</span>
    <span class="n">session</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">allow_prompts</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">echo_console</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Normalize existing_file_action for the current run-mode.
- If 'case_by_case' is set but prompts are not allowed (automatic mode),
  coerce to 'skip_all' and warn.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current session state.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>allow_prompts</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether prompts are allowed (i.e., interactive mode).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger</code>
            </td>
            <td>
                  <code><span title="weather_data_retrieval.utils.logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Logger for logging messages.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>echo_console</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to echo messages to console.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Normalized existing_file_action policy.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.data_validation.validate_config" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">validate_config</span>


<a href="#weather_data_retrieval.utils.data_validation.validate_config" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">validate_config</span><span class="p">(</span>
    <span class="n">config</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">run_mode</span><span class="o">=</span><span class="s2">&quot;automatic&quot;</span><span class="p">,</span>
    <span class="n">echo_console</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">live_auth_check</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Entry point. Validates common shape then dispatches to provider-specific validator.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration dictionary.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger</code>
            </td>
            <td>
                  <code><span title="weather_data_retrieval.utils.logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Logger for logging messages, by default None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>run_mode</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Run mode, either 'interactive' or 'automatic', by default "automatic".</p>
              </div>
            </td>
            <td>
                  <code>&#39;automatic&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>echo_console</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to echo messages to console, by default False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>live_auth_check</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to perform live authentication checks (e.g., CDS API), by default False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div><p><strong>Key Functions</strong>:</p>
<p><strong><code>validate_config(config, logger, run_mode)</code></strong></p>
<p>Comprehensive configuration validation. Checks:</p>
<ul>
<li>All required fields are present</li>
<li>Data types are correct</li>
<li>Values are in valid ranges</li>
<li>Enumerations match allowed values</li>
<li>Dates are properly formatted and logical</li>
<li>Region bounds are valid</li>
</ul>
<p><strong>Side Effects</strong>:
- Clamps out-of-range values with warnings
- Converts incompatible settings (e.g., <code>prompt</code> → <code>skip_all</code> in batch mode)</p>
<p><strong><code>validate_cds_api_key(api_url, api_key, logger, echo_console)</code></strong></p>
<p>Tests CDS API credentials by attempting to create a client connection.</p>
<p><strong>Returns</strong>:
- <code>cdsapi.Client</code> if successful, else <code>None</code></p>
<p><strong><code>invalid_era5_world_variables(variables)</code></strong></p>
<p>Checks for invalid variable names in ERA5 (world) dataset.</p>
<p><strong>Returns</strong>:
- <code>list</code>: Invalid variable names (empty if all valid)</p>
<p><strong><code>invalid_era5_land_variables(variables)</code></strong></p>
<p>Checks for invalid variable names in ERA5-Land dataset.</p>
<p><strong>Returns</strong>:
- <code>list</code>: Invalid variable names (empty if all valid)</p>
<p><strong>Formatting Helpers</strong>:</p>
<ul>
<li><code>format_coordinates_nwse(boundaries)</code> - Convert bounds to string like <code>"N40W10S35E5"</code></li>
<li><code>format_duration(seconds)</code> - Convert seconds to human-readable duration</li>
<li><code>validate_date_format(date_string)</code> - Check if date string is valid YYYY-MM-DD</li>
</ul>
<hr />
<h3 id="utilsfile_managementpy"><code>utils/file_management.py</code><a class="headerlink" href="#utilsfile_managementpy" title="Permanent link">&para;</a></h3>
<p>File naming, checking, and estimation functions.</p>


<div class="doc doc-object doc-module">



<h4 id="weather_data_retrieval.utils.file_management" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">weather_data_retrieval.utils.file_management</span>


<a href="#weather_data_retrieval.utils.file_management" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents first">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.file_management.generate_filename_hash" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">generate_filename_hash</span>


<a href="#weather_data_retrieval.utils.file_management.generate_filename_hash" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">generate_filename_hash</span><span class="p">(</span>
    <span class="n">dataset_short_name</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">boundaries</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate a unique hash for the download parameters that will be used to create the filename.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset_short_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataset short name (era5-world etc).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>variables</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of variable names.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>boundaries</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of boundaries [north, west, south, east].</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>    str: A unique hash string representing the download parameters.</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.file_management.find_existing_month_file" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">find_existing_month_file</span>


<a href="#weather_data_retrieval.utils.file_management.find_existing_month_file" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">find_existing_month_file</span><span class="p">(</span>
    <span class="n">save_dir</span><span class="p">,</span> <span class="n">filename_base</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">month</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Tolerant matcher that finds an existing file for the given month.
Accepts both <code>_YYYY-MM.ext</code> and <code>_YYYY_MM.ext</code> patterns and any extension.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>save_dir</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory where files are saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filename_base</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base filename (without date or extension).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>year</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Year of the file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>month</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Month of the file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the existing file if found, else None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.file_management.estimate_era5_monthly_file_size" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">estimate_era5_monthly_file_size</span>


<a href="#weather_data_retrieval.utils.file_management.estimate_era5_monthly_file_size" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">estimate_era5_monthly_file_size</span><span class="p">(</span>
    <span class="n">variables</span><span class="p">,</span>
    <span class="n">area</span><span class="p">,</span>
    <span class="n">grid_resolution</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
    <span class="n">timestep_hours</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">bytes_per_value</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Estimate ERA5 GRIB file size (MB) for a monthly dataset.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>variables</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Variables requested (e.g. ['2m_temperature', 'total_precipitation']).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>area</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>[north, west, south, east] geographic bounds in degrees.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>grid_resolution</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Grid spacing in degrees (default 0.25° for ERA5).</p>
              </div>
            </td>
            <td>
                  <code>0.25</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timestep_hours</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Temporal resolution in hours (1 = hourly, 3 = 3-hourly, 6 = 6-hourly, etc.).</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bytes_per_value</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Bytes per gridpoint per variable (float32 = 4 bytes).</p>
              </div>
            </td>
            <td>
                  <code>4.0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Estimated monthly file size in MB.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.file_management.estimate_cds_download" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">estimate_cds_download</span>


<a href="#weather_data_retrieval.utils.file_management.estimate_cds_download" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">estimate_cds_download</span><span class="p">(</span>
    <span class="n">variables</span><span class="p">,</span>
    <span class="n">area</span><span class="p">,</span>
    <span class="n">start_date</span><span class="p">,</span>
    <span class="n">end_date</span><span class="p">,</span>
    <span class="n">observed_speed_mbps</span><span class="p">,</span>
    <span class="n">grid_resolution</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
    <span class="n">timestep_hours</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">bytes_per_value</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span>
    <span class="n">overhead_per_request_s</span><span class="o">=</span><span class="mf">180.0</span><span class="p">,</span>
    <span class="n">overhead_per_var_s</span><span class="o">=</span><span class="mf">12.0</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Estimate per-file and total download size/time for CDS (ERA5) retrievals,
using an empirically grounded file size model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>variables</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Variables selected (e.g. ['2m_temperature', 'total_precipitation']).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>area</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>[north, west, south, east] bounds in degrees.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>start_date</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Date range (YYYY-MM-DD).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end_date</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Date range (YYYY-MM-DD).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>observed_speed_mbps</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Measured internet speed in megabits per second (Mbps).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>grid_resolution</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Grid resolution in degrees (default 0.25°).</p>
              </div>
            </td>
            <td>
                  <code>0.25</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timestep_hours</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Temporal resolution in hours (default 1-hourly).</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bytes_per_value</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Bytes per stored value (float32 = 4).</p>
              </div>
            </td>
            <td>
                  <code>4.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overhead_per_request_s</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fixed CDS request overhead time (queue/prep).</p>
              </div>
            </td>
            <td>
                  <code>180.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overhead_per_var_s</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Per-variable overhead for CDS throttling/prep.</p>
              </div>
            </td>
            <td>
                  <code>12.0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>{
  "months": int,
  "file_size_MB": float,
  "total_size_MB": float,
  "time_per_file_sec": float,
  "total_time_sec": float
}</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.file_management.expected_save_stem" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">expected_save_stem</span>


<a href="#weather_data_retrieval.utils.file_management.expected_save_stem" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">expected_save_stem</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="n">filename_base</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Construct canonical save stem (without extension) for monthly data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>save_dir</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base directory for saving. If None, defaults to osme_common.paths.data_dir().</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filename_base</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base name without date or extension.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>year</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Year and month of the file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>month</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Year and month of the file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Resolved path under the proper data directory.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.file_management.expected_save_path" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">expected_save_path</span>


<a href="#weather_data_retrieval.utils.file_management.expected_save_path" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">expected_save_path</span><span class="p">(</span>
    <span class="n">save_dir</span><span class="p">,</span> <span class="n">filename_base</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">data_format</span><span class="o">=</span><span class="s2">&quot;grib&quot;</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Construct canonical save path for monthly data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>save_dir</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base directory for saving. If None, defaults to osme_common.paths.data_dir().</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filename_base</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base name without date or extension.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>year</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Year and month of the file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>month</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Year and month of the file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_format</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>File extension, e.g., 'grib' or 'nc'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;grib&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Resolved path under the proper data directory.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.file_management.is_zip_file" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">is_zip_file</span>


<a href="#weather_data_retrieval.utils.file_management.is_zip_file" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">is_zip_file</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check if a file is a ZIP archive by reading its magic number.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the file to check.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the file is a ZIP archive, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.file_management.is_grib_file" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">is_grib_file</span>


<a href="#weather_data_retrieval.utils.file_management.is_grib_file" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">is_grib_file</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check if a file is a GRIB file by reading its magic number.
GRIB files begin with ASCII bytes 'GRIB'.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the file to check.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the file is a GRIB file, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.file_management.unpack_zip_to_grib" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">unpack_zip_to_grib</span>


<a href="#weather_data_retrieval.utils.file_management.unpack_zip_to_grib" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">unpack_zip_to_grib</span><span class="p">(</span><span class="n">zip_path</span><span class="p">,</span> <span class="n">final_grib_path</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Extract a ZIP and move the contained GRIB-like file to final_grib_path.
If multiple candidates exist, prefer .grib/.grb/.grib2; otherwise take the largest file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>zip_path</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the ZIP file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>final_grib_path</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Desired final path for the extracted GRIB file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the final GRIB file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div><p><strong>Key Functions</strong>:</p>
<p><strong><code>generate_filename_hash(dataset_short_name, variables, boundaries)</code></strong></p>
<p>Creates a unique 12-character hash from download parameters. This ensures files with different parameters don't collide.</p>
<p><strong>Returns</strong>:
- <code>str</code>: 12-character hash (e.g., <code>"abc123def456"</code>)</p>
<p><strong><code>find_existing_month_file(save_dir, filename_base, year, month)</code></strong></p>
<p>Searches for an existing file for a given month, handling different date separators and extensions.</p>
<p><strong>Returns</strong>:
- <code>Path</code> if file exists, else <code>None</code></p>
<p><strong><code>estimate_era5_monthly_file_size(variables, area, grid_resolution, ...)</code></strong></p>
<p>Estimates file size for a monthly ERA5 download based on empirical data.</p>
<p><strong>Parameters</strong>:
- <code>variables</code> (list): Variables to download
- <code>area</code> (list): Region bounds
- <code>grid_resolution</code> (float): Grid spacing in degrees
- <code>timestep_hours</code> (float): Temporal resolution
- <code>bytes_per_value</code> (float): Storage size per value</p>
<p><strong>Returns</strong>:
- <code>float</code>: Estimated size in MB</p>
<p><strong><code>estimate_cds_download(variables, area, start_date, end_date, observed_speed_mbps, ...)</code></strong></p>
<p>Comprehensive download estimation including size, time, and parallelization effects.</p>
<p><strong>Returns</strong>:
- <code>dict</code>: 
  <div class="highlight"><pre><span></span><code><span class="p">{</span>
  <span class="s2">&quot;months&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>              <span class="c1"># Number of monthly files</span>
  <span class="s2">&quot;file_size_MB&quot;</span><span class="p">:</span> <span class="mf">42.3</span><span class="p">,</span>      <span class="c1"># Average file size</span>
  <span class="s2">&quot;total_size_MB&quot;</span><span class="p">:</span> <span class="mf">507.6</span><span class="p">,</span>    <span class="c1"># Total download size</span>
  <span class="s2">&quot;time_per_file_sec&quot;</span><span class="p">:</span> <span class="mi">180</span><span class="p">,</span>  <span class="c1"># Time per file</span>
  <span class="s2">&quot;total_time_sec&quot;</span><span class="p">:</span> <span class="mi">2160</span>     <span class="c1"># Total estimated time</span>
<span class="p">}</span>
</code></pre></div></p>
<p><strong>File Format Helpers</strong>:</p>
<ul>
<li><code>is_zip_file(path)</code> - Check if file is a ZIP archive</li>
<li><code>is_grib_file(path)</code> - Check if file is a GRIB file</li>
<li><code>unpack_zip_to_grib(zip_path, final_grib_path)</code> - Extract GRIB from ZIP</li>
</ul>
<hr />
<h3 id="utilsloggingpy"><code>utils/logging.py</code><a class="headerlink" href="#utilsloggingpy" title="Permanent link">&para;</a></h3>
<p>Logging configuration and utilities.</p>


<div class="doc doc-object doc-module">



<h4 id="weather_data_retrieval.utils.logging" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">weather_data_retrieval.utils.logging</span>


<a href="#weather_data_retrieval.utils.logging" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents first">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.logging.build_download_summary" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">build_download_summary</span>


<a href="#weather_data_retrieval.utils.logging.build_download_summary" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">build_download_summary</span><span class="p">(</span>
    <span class="n">session</span><span class="p">,</span> <span class="n">estimates</span><span class="p">,</span> <span class="n">speed_mbps</span><span class="p">,</span> <span class="n">save_dir</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Construct a formatted summary string of the current download configuration.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session</code>
            </td>
            <td>
                  <code><span title="SessionState">SessionState</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current session state containing all parameters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>estimates</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary containing download size and time estimates.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>speed_mbps</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Measured or estimated internet speed in Mbps.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nicely formatted summary string for display or logging.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.logging.setup_logger" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">setup_logger</span>


<a href="#weather_data_retrieval.utils.logging.setup_logger" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">setup_logger</span><span class="p">(</span>
    <span class="n">save_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">run_mode</span><span class="o">=</span><span class="s2">&quot;interactive&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize and return a configured logger.</p>
<p>Logs are written to <repo_root>/logs (or $OSME_LOG_DIR) by default,
with optional console output in interactive or verbose modes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>save_dir</code>
            </td>
            <td>
                  <code><span title="str">str</span> or None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory to save log files. If None, defaults to osme_common.paths.log_dir().</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>run_mode</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Either 'interactive' or 'automatic', by default 'interactive'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;interactive&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to echo logs to console in automatic mode, by default False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configured logger instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.logging.log_msg" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">log_msg</span>


<a href="#weather_data_retrieval.utils.logging.log_msg" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">log_msg</span><span class="p">(</span>
    <span class="n">msg</span><span class="p">,</span>
    <span class="n">logger</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">level</span><span class="o">=</span><span class="s2">&quot;info&quot;</span><span class="p">,</span>
    <span class="n">echo_console</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">force</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Unified logging utility.
- Always logs to file.
- Optionally echoes to console via tqdm.write.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>echo_console</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print to console when True (used for verbose mode).</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>force</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print to console regardless of echo_console (used for summaries/errors).</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="weather_data_retrieval.utils.logging.create_final_log_file" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">create_final_log_file</span>


<a href="#weather_data_retrieval.utils.logging.create_final_log_file" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_final_log_file</span><span class="p">(</span>
    <span class="n">session</span><span class="p">,</span>
    <span class="n">filename_base</span><span class="p">,</span>
    <span class="n">original_logger</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">delete_original</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">reattach_to_final</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a final log file with the same naming pattern as data files.
Copies content from the original log file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span>(<span title="SessionState">SessionState</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current session state.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filename_base</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base filename pattern (same as data files).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>original_logger</code>
            </td>
            <td>
                  <code><span title="logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The original logger instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>delete_original</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to delete the original log file after creating the final one, by default True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>reattach_to_final</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to reattach the logger to the final log file, by default True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the final log file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div><p><strong>Key Functions</strong>:</p>
<p><strong><code>setup_logger(save_dir, run_mode, verbose)</code></strong></p>
<p>Initializes a configured logger for the package.</p>
<p><strong>Parameters</strong>:
- <code>save_dir</code> (str, optional): Directory for log files (defaults to <code>logs/weather_data_retrieval/</code>)
- <code>run_mode</code> (str): <code>"interactive"</code> or <code>"automatic"</code>
- <code>verbose</code> (bool): Whether to show console output</p>
<p><strong>Returns</strong>:
- <code>logging.Logger</code>: Configured logger instance</p>
<p><strong>Configuration</strong>:
- File handler: DEBUG level (everything)
- Console handler: INFO level (only in interactive or verbose mode)
- Format: <code>"%(asctime)s | %(levelname)s | %(message)s"</code></p>
<p><strong><code>log_msg(msg, logger, level, echo_console, force)</code></strong></p>
<p>Unified logging utility that writes to file and optionally to console.</p>
<p><strong>Parameters</strong>:
- <code>msg</code> (str): Message to log
- <code>logger</code> (logging.Logger): Logger instance
- <code>level</code> (str): <code>"debug"</code>, <code>"info"</code>, <code>"warning"</code>, <code>"error"</code>, <code>"exception"</code>
- <code>echo_console</code> (bool): Print to console
- <code>force</code> (bool): Print even if <code>echo_console=False</code> (for critical messages)</p>
<p><strong><code>build_download_summary(session, estimates, speed_mbps, save_dir)</code></strong></p>
<p>Constructs a formatted summary of the download configuration.</p>
<p><strong>Returns</strong>:
- <code>str</code>: Multi-line summary string</p>
<p><strong><code>create_final_log_file(session, filename_base, original_logger, ...)</code></strong></p>
<p>Creates a final log file with the same naming convention as data files.</p>
<p><strong>Parameters</strong>:
- <code>session</code> (SessionState): Current session
- <code>filename_base</code> (str): Base filename
- <code>original_logger</code> (logging.Logger): Current logger
- <code>delete_original</code> (bool): Remove temporary log
- <code>reattach_to_final</code> (bool): Continue logging to final file</p>
<p><strong>Returns</strong>:
- <code>str</code>: Path to final log file</p>
<hr />
<h2 id="usage-examples">Usage Examples<a class="headerlink" href="#usage-examples" title="Permanent link">&para;</a></h2>
<h3 id="creating-a-custom-download-script">Creating a Custom Download Script<a class="headerlink" href="#creating-a-custom-download-script" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">weather_data_retrieval.runner</span><span class="w"> </span><span class="kn">import</span> <span class="n">run</span>

<span class="c1"># Define your configuration</span>
<span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;data_provider&quot;</span><span class="p">:</span> <span class="s2">&quot;cds&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dataset_short_name&quot;</span><span class="p">:</span> <span class="s2">&quot;era5-land&quot;</span><span class="p">,</span>
    <span class="s2">&quot;api_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://cds.climate.copernicus.eu/api&quot;</span><span class="p">,</span>
    <span class="s2">&quot;api_key&quot;</span><span class="p">:</span> <span class="s2">&quot;YOUR_KEY&quot;</span><span class="p">,</span>
    <span class="s2">&quot;start_date&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-01-01&quot;</span><span class="p">,</span>
    <span class="s2">&quot;end_date&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-03-31&quot;</span><span class="p">,</span>
    <span class="s2">&quot;region_bounds&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
    <span class="s2">&quot;variables&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2m_temperature&quot;</span><span class="p">],</span>
    <span class="s2">&quot;existing_file_action&quot;</span><span class="p">:</span> <span class="s2">&quot;skip_all&quot;</span><span class="p">,</span>
    <span class="s2">&quot;retry_settings&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;max_retries&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;retry_delay_sec&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">},</span>
    <span class="s2">&quot;parallel_settings&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;max_concurrent&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Run the download</span>
<span class="n">exit_code</span> <span class="o">=</span> <span class="n">run</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">run_mode</span><span class="o">=</span><span class="s2">&quot;automatic&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">if</span> <span class="n">exit_code</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Download completed successfully!&quot;</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">exit_code</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Download completed with some failures. Check logs.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Download failed. Check logs.&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="validating-a-config-before-running">Validating a Config Before Running<a class="headerlink" href="#validating-a-config-before-running" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">weather_data_retrieval.utils.data_validation</span><span class="w"> </span><span class="kn">import</span> <span class="n">validate_config</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">weather_data_retrieval.utils.logging</span><span class="w"> </span><span class="kn">import</span> <span class="n">setup_logger</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">setup_logger</span><span class="p">(</span><span class="n">run_mode</span><span class="o">=</span><span class="s2">&quot;automatic&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">config</span> <span class="o">=</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>  <span class="c1"># Your config</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">validate_config</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">run_mode</span><span class="o">=</span><span class="s2">&quot;automatic&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✓ Configuration is valid!&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✗ Configuration error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="estimating-download-before-running">Estimating Download Before Running<a class="headerlink" href="#estimating-download-before-running" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">weather_data_retrieval.utils.file_management</span><span class="w"> </span><span class="kn">import</span> <span class="n">estimate_cds_download</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">weather_data_retrieval.utils.session_management</span><span class="w"> </span><span class="kn">import</span> <span class="n">internet_speedtest</span>

<span class="c1"># Test internet speed</span>
<span class="n">speed_mbps</span> <span class="o">=</span> <span class="n">internet_speedtest</span><span class="p">(</span><span class="n">max_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">echo_console</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Estimate download</span>
<span class="n">estimates</span> <span class="o">=</span> <span class="n">estimate_cds_download</span><span class="p">(</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;2m_temperature&quot;</span><span class="p">,</span> <span class="s2">&quot;total_precipitation&quot;</span><span class="p">],</span>
    <span class="n">area</span><span class="o">=</span><span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
    <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;2023-01-01&quot;</span><span class="p">,</span>
    <span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;2023-12-31&quot;</span><span class="p">,</span>
    <span class="n">observed_speed_mbps</span><span class="o">=</span><span class="n">speed_mbps</span><span class="p">,</span>
    <span class="n">grid_resolution</span><span class="o">=</span><span class="mf">0.1</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estimated files: </span><span class="si">{</span><span class="n">estimates</span><span class="p">[</span><span class="s1">&#39;months&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total size: </span><span class="si">{</span><span class="n">estimates</span><span class="p">[</span><span class="s1">&#39;total_size_MB&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estimated time: </span><span class="si">{</span><span class="n">estimates</span><span class="p">[</span><span class="s1">&#39;total_time_sec&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">60</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> minutes&quot;</span><span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="extending-the-package">Extending the Package<a class="headerlink" href="#extending-the-package" title="Permanent link">&para;</a></h2>
<h3 id="adding-a-new-data-provider">Adding a New Data Provider<a class="headerlink" href="#adding-a-new-data-provider" title="Permanent link">&para;</a></h3>
<p>To add a new provider (e.g., Open-Meteo):</p>
<ol>
<li>
<p><strong>Create provider module</strong>: <code>sources/my_provider.py</code></p>
</li>
<li>
<p><strong>Implement download function</strong>:
   <div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">orchestrate_my_provider_downloads</span><span class="p">(</span>
    <span class="n">session</span><span class="p">,</span> <span class="n">filename_base</span><span class="p">,</span> <span class="n">save_dir</span><span class="p">,</span>
    <span class="n">successful_downloads</span><span class="p">,</span> <span class="n">failed_downloads</span><span class="p">,</span> <span class="n">skipped_downloads</span><span class="p">,</span>
    <span class="n">logger</span><span class="p">,</span> <span class="n">echo_console</span><span class="p">,</span> <span class="n">allow_prompts</span>
<span class="p">):</span>
    <span class="c1"># Your implementation</span>
    <span class="k">pass</span>
</code></pre></div></p>
</li>
<li>
<p><strong>Add to session mapping</strong>: Update <code>session_management.py</code> to handle new provider</p>
</li>
<li>
<p><strong>Add validation</strong>: Update <code>data_validation.py</code> to validate provider-specific params</p>
</li>
<li>
<p><strong>Update prompts</strong>: Add provider selection in <code>io/prompts.py</code></p>
</li>
</ol>
<h3 id="adding-new-variables">Adding New Variables<a class="headerlink" href="#adding-new-variables" title="Permanent link">&para;</a></h3>
<p>Variables are validated against hard-coded lists in <code>data_validation.py</code>:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># In data_validation.py</span>

<span class="n">ERA5_LAND_VARIABLES</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;2m_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;total_precipitation&quot;</span><span class="p">,</span>
    <span class="c1"># ... add new variable here</span>
<span class="p">]</span>
</code></pre></div>
<h3 id="adding-new-configuration-parameters">Adding New Configuration Parameters<a class="headerlink" href="#adding-new-configuration-parameters" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>Define in SessionState</strong>: Add to the required/optional keys list</p>
</li>
<li>
<p><strong>Add validation</strong>: Update <code>validate_config()</code> in <code>data_validation.py</code></p>
</li>
<li>
<p><strong>Add prompt</strong> (if interactive): Create <code>prompt_new_parameter()</code> in <code>io/prompts.py</code></p>
</li>
<li>
<p><strong>Use in runner</strong>: Access via <code>session.get("new_parameter")</code> in your code</p>
</li>
</ol>
<hr />
<h2 id="testing">Testing<a class="headerlink" href="#testing" title="Permanent link">&para;</a></h2>
<h3 id="running-unit-tests">Running Unit Tests<a class="headerlink" href="#running-unit-tests" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># From repo root</span>
pytest<span class="w"> </span>packages/weather_data_retrieval/tests/
</code></pre></div>
<h3 id="testing-individual-modules">Testing Individual Modules<a class="headerlink" href="#testing-individual-modules" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Test validation</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">weather_data_retrieval.utils.data_validation</span><span class="w"> </span><span class="kn">import</span> <span class="n">validate_config</span>

<span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span>
<span class="n">validate_config</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">run_mode</span><span class="o">=</span><span class="s2">&quot;automatic&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="mock-testing-downloads">Mock Testing Downloads<a class="headerlink" href="#mock-testing-downloads" title="Permanent link">&para;</a></h3>
<p>For testing without hitting the CDS API, you can mock the download functions:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">unittest.mock</span><span class="w"> </span><span class="kn">import</span> <span class="n">patch</span><span class="p">,</span> <span class="n">MagicMock</span>

<span class="k">with</span> <span class="n">patch</span><span class="p">(</span><span class="s1">&#39;weather_data_retrieval.sources.cds_era5.download_monthly_era5_file&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">mock_download</span><span class="p">:</span>
    <span class="n">mock_download</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;/fake/file.grib&quot;</span><span class="p">)</span>
    <span class="c1"># Run your test</span>
</code></pre></div>
<hr />
<h2 id="further-reading">Further Reading<a class="headerlink" href="#further-reading" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="../user-guide/">User Guide</a> for usage patterns</li>
<li><a href="../configuration/">Configuration Reference</a> for all parameters</li>
<li><a href="troubleshooting.md">Troubleshooting</a> for common issues</li>
<li><a href="https://github.com/danielkaupa/open-source-marginal-emissions">GitHub Repository</a> for source code</li>
</ul>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.instant", "search.suggest", "search.highlight", "toc.integrate", "content.code.copy", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>